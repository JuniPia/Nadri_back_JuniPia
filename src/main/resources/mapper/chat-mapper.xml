<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.co.iei.chat.model.dao.ChatDao">
  <select id ="selectGroupList" resultType="int">
  	select chat_no from chat_group where member_nickname=#{memberNickname}
  </select>
  <select id="selectRoomData" resultType="chatRoom">
  	select c.*, (select count(*) from chat_group where chat_no=c.chat_no) group_size, (select count(*) from chat_not_read) not_read
	from chat c where c.chat_no in
		<foreach collection="chatList" item="chatNo" open="(" close=")" separator="," >
			#{chatNo}
		</foreach>
  </select>
  <select id="selectChatContent" resultType="chatContent">
  	select member_nickname, chat_img,chat_content from chat_content where chat_no=#{chatNo}
  </select>
  <insert id="insertText">
  	insert into chat_content values(chat_content_seq.nextval, #{memberNickname},#{chatNo},null,#{chatContent})
  </insert>
</mapper>
